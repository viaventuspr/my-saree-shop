<section id="shop" class="products-section">
    <h2 style="text-align: center; margin-top: 20px;">අපගේ නවතම සාරි එකතුව</h2>
    <div id="product-list" class="product-grid">
        <p style="text-align: center; width: 100%;">නිෂ්පාදන පූරණය වෙමින් පවතී...</p>
    </div>
</section>

<script>
    const sheetID = '1YNPAC7OCg47t-OBKaG91_q39qGU6MePatB8uL-rLVFg';
    const base = `https://docs.google.com/spreadsheets/d/${sheetID}/gviz/tq?tqx=out:json`;

    fetch(base)
        .then(res => res.text())
        .then(data => {
            // Google Sheet එකෙන් එන දත්ත පිරිසිදු කිරීම
            const temp = data.substring(47).slice(0, -2);
            const json = JSON.parse(temp);
            const rows = json.table.rows;
            const container = document.getElementById('product-list');
            
            // පූරණය වෙමින් පවතී යන පණිවිඩය ඉවත් කිරීම
            container.innerHTML = '';

            rows.forEach(row => {
                // සාරි විස්තර (Column A, B, C)
                const name = row.c[0] ? row.c[0].v : "නමක් නොමැත";
                const price = row.c[1] ? row.c[1].v : "0.00";
                const img = row.c[2] ? row.c[2].v : "https://via.placeholder.com/300";

                // HTML එකට එකතු කිරීම
                container.innerHTML += `
                    <div class="product-card" style="border: 1px solid #ddd; padding: 15px; border-radius: 10px; text-align: center; box-shadow: 2px 2px 10px rgba(0,0,0,0.1);">
                        <img src="${img}" alt="${name}" style="width: 100%; height: 250px; object-fit: cover; border-radius: 5px;">
                        <h3 style="margin: 10px 0;">${name}</h3>
                        <p style="color: #e91e63; font-weight: bold;">රු. ${price}</p>
                        <button style="background: #e91e63; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">දැන්ම ඇණවුම් කරන්න</button>
                    </div>
                `;
            });
        })
        .catch(err => {
            console.error(err);
            document.getElementById('product-list').innerHTML = "දත්ත ලබා ගැනීමේදී දෝෂයක් සිදුවිය. කරුණාකර Sheet එකේ Share Settings පරීක්ෂා කරන්න.";
        });
</script>
