<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∑É‡∑í‡∂ª‡∑í ‡∑É‡∑è‡∂ª‡∑í | Premium Saree Collection</title>
    <meta name="description" content="‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è‡∑Ä‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑î‡∂õ‡∂≠‡∂∏ ‡∑É‡∑è‡∂ª‡∑í ‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä - ‡∑É‡∂∏‡∑ä‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∑è‡∂∫‡∑í‡∂ö ‡∑É‡∑Ñ ‡∂±‡∑Ä‡∑ì‡∂± ‡∑É‡∑è‡∂ª‡∑í">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700;800&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #8B4513;
            --primary-dark: #5D2E0F;
            --accent: #D4AF37;
            --accent-light: #F4E4C1;
            --text-dark: #2C1810;
            --text-medium: #6B4423;
            --bg-cream: #FAF6F0;
            --bg-white: #FFFFFF;
            --border-color: #E8DCC8;
            --shadow: rgba(139, 69, 19, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Lato', sans-serif;
            background: var(--bg-cream);
            color: var(--text-dark);
            line-height: 1.6;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 20px var(--shadow);
        }

        .top-bar {
            background: rgba(0, 0, 0, 0.2);
            padding: 8px 0;
            font-size: 0.85rem;
            text-align: center;
        }

        .top-bar a {
            color: var(--accent-light);
            text-decoration: none;
            margin: 0 15px;
        }

        .header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 5%;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 30px;
        }

        nav a {
            color: white;
            text-decoration: none;
            text-transform: uppercase;
            font-size: 0.9rem;
            transition: color 0.3s;
        }

        nav a:hover {
            color: var(--accent);
        }

        .header-actions {
            display: flex;
            gap: 15px;
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .icon-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .admin-btn {
            background: var(--accent);
            color: var(--text-dark);
            font-weight: 700;
        }

        /* Hero */
        .hero {
            background: linear-gradient(rgba(139, 69, 19, 0.7), rgba(93, 46, 15, 0.8)),
                        url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 400"><rect fill="%238B4513" width="1200" height="400"/></svg>');
            padding: 100px 5%;
            text-align: center;
            color: white;
        }

        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4rem;
            margin-bottom: 20px;
        }

        /* Products */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 5%;
        }

        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--primary);
            text-align: center;
            margin-bottom: 40px;
        }

        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 30px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 15px var(--shadow);
            transition: transform 0.3s;
        }

        .product-card:hover {
            transform: translateY(-10px);
        }

        .product-image {
            height: 350px;
            background: linear-gradient(135deg, var(--bg-cream), #E8DCC8);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 5rem;
            position: relative;
        }

        .product-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: var(--accent);
            color: var(--text-dark);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .product-info {
            padding: 20px;
        }

        .product-category {
            color: var(--text-medium);
            font-size: 0.85rem;
            text-transform: uppercase;
            margin-bottom: 8px;
        }

        .product-name {
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.4rem;
            color: var(--primary-dark);
            margin-bottom: 10px;
        }

        .product-price {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .price {
            font-size: 1.6rem;
            color: var(--primary);
            font-weight: 700;
        }

        .price-original {
            text-decoration: line-through;
            color: var(--text-medium);
        }

        .add-to-cart-btn {
            width: 100%;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            border: none;
            padding: 14px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .add-to-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(139, 69, 19, 0.4);
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 100px 20px;
            font-size: 1.5rem;
            color: var(--primary);
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2000;
            overflow-y: auto;
        }

        .admin-panel.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-content {
            background: white;
            max-width: 900px;
            width: 90%;
            margin: 50px auto;
            padding: 40px;
            border-radius: 15px;
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .close-admin {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
        }

        .info-box {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }

        .info-box h3 {
            color: #1976D2;
            margin-bottom: 10px;
        }

        .info-box code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }

        .step {
            background: white;
            border: 2px solid var(--border-color);
            padding: 20px;
            margin: 15px 0;
            border-radius: 10px;
        }

        .step h4 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent), #C9A32A);
            color: var(--text-dark);
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            width: 100%;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(212, 175, 55, 0.4);
        }

        /* Footer */
        footer {
            background: linear-gradient(135deg, var(--primary-dark), #3D1F0B);
            color: white;
            padding: 50px 5%;
            margin-top: 80px;
            text-align: center;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-main {
                flex-direction: column;
                gap: 20px;
            }

            nav ul {
                flex-direction: column;
                text-align: center;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .product-grid {
                grid-template-columns: 1fr;
            }

            .admin-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="top-bar">
            <a href="tel:+94771234567">üìû +94 77 123 4567</a>
            <a href="mailto:info@sirisaree.lk">‚úâÔ∏è info@sirisaree.lk</a>
            <span>üöö ‡∂±‡∑ú‡∂∏‡∑í‡∂Ω‡∑ö ‡∂∂‡∑ô‡∂Ø‡∑è‡∑Ñ‡∑ê‡∂ª‡∑ì‡∂∏ ‡∂ª‡∑î. 5000 ‡∂ß ‡∑Ä‡∑ê‡∂©‡∑í ‡∂á‡∂´‡∑Ä‡∑î‡∂∏‡∑ä</span>
        </div>
        <div class="header-main">
            <div class="logo">‡∑É‡∑í‡∂ª‡∑í ‡∑É‡∑è‡∂ª‡∑í</div>
            <nav>
                <ul>
                    <li><a href="#home">‡∂∏‡∑î‡∂Ω‡∑ä ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä</a></li>
                    <li><a href="#products">‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä</a></li>
                    <li><a href="#about">‡∂Ö‡∂¥ ‡∂ú‡∑ê‡∂±</a></li>
                    <li><a href="#contact">‡∂Ö‡∂∏‡∂≠‡∂±‡∑ä‡∂±</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <button class="icon-btn admin-btn" onclick="openAdmin()">üîê Admin</button>
                <button class="icon-btn">üõí ‡∂ö‡∂ª‡∂≠‡∑ä‡∂≠‡∂∫</button>
            </div>
        </div>
    </header>

    <!-- Hero -->
    <section class="hero" id="home">
        <h1>‡∂Ö‡∂¥‡∑ñ‡∂ª‡∑î ‡∑É‡∑è‡∂ª‡∑í ‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä</h1>
        <p style="font-size: 1.3rem; font-family: 'Cormorant Garamond', serif;">
            ‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è‡∑Ä‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑î‡∂õ‡∂≠‡∂∏ ‡∑É‡∑è‡∂ª‡∑í ‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä - Google Sheets ‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä real-time update ‡∑Ä‡∂± system ‡∂ë‡∂ö‡∂ö‡∑ä
        </p>
    </section>

    <!-- Products -->
    <div class="container" id="products">
        <h2 class="section-title">‡∂Ö‡∂¥‡∂ú‡∑ö ‡∂ë‡∂ö‡∂≠‡∑î‡∑Ä</h2>
        <div id="productGrid" class="product-grid">
            <div class="loading">‚è≥ ‡∂±‡∑í‡∑Ç‡∑ä‡∂¥‡∑è‡∂Ø‡∂± load ‡∑Ä‡∑ô‡∂∏‡∑í‡∂±‡∑ä...</div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <h3 style="font-family: 'Playfair Display', serif; margin-bottom: 20px;">‡∑É‡∑í‡∂ª‡∑í ‡∑É‡∑è‡∂ª‡∑í</h3>
        <p>‡∂ö‡∑ú‡∑Ö‡∂π 03, ‡∑Å‡∑ä‚Äç‡∂ª‡∑ì ‡∂Ω‡∂Ç‡∂ö‡∑è‡∑Ä | +94 77 123 4567 | info@sirisaree.lk</p>
        <p style="margin-top: 20px; opacity: 0.8;">¬© 2026 ‡∑É‡∑í‡∂ª‡∑í ‡∑É‡∑è‡∂ª‡∑í. ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∑Ñ‡∑í‡∂∏‡∑í‡∂ö‡∂∏‡∑ä ‡∂á‡∑Ä‡∑í‡∂ª‡∑í‡∂´‡∑í.</p>
    </footer>

    <!-- Admin Panel -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-content">
            <div class="admin-header">
                <h2 style="font-family: 'Playfair Display', serif; color: var(--primary);">
                    Admin Panel - Google Sheets Integration
                </h2>
                <button class="close-admin" onclick="closeAdmin()">‚úï ‡∑Ä‡∑É‡∂±‡∑ä‡∂±</button>
            </div>

            <div class="info-box">
                <h3>üìä Google Sheets Integration Setup</h3>
                <p>‡∂î‡∂∂‡∑ö website ‡∂ë‡∂ö Google Sheets ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑É‡∂∏‡∂ú connect ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑Ñ‡∂≠ steps follow ‡∂ö‡∂ª‡∂±‡∑ä‡∂±:</p>
            </div>

            <div class="step">
                <h4>Step 1: Google Sheet ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∑è‡∂ú‡∂±‡∑ä‡∂±</h4>
                <p>1. Google Sheets ‡∂ë‡∂ö‡∂ß ‡∂∫‡∂±‡∑ä‡∂±: <a href="https://sheets.google.com" target="_blank">sheets.google.com</a></p>
                <p>2. ‡∂±‡∑Ä spreadsheet ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ñ‡∂Ø‡∑è‡∂ú‡∂±‡∑ä‡∂±</p>
                <p>3. ‡∂¥‡∑Ñ‡∂≠ column headers add ‡∂ö‡∂ª‡∂±‡∑ä‡∂± (Row 1):</p>
                <code style="display: block; margin: 10px 0; padding: 10px; background: #f5f5f5;">
                    name | category | price | originalPrice | color | description | badge | image
                </code>
                <p>4. Sample data add ‡∂ö‡∂ª‡∂±‡∑ä‡∂±:</p>
                <code style="display: block; margin: 10px 0; padding: 10px; background: #f5f5f5; font-size: 0.85rem;">
                    Row 2: ‡∑É‡∂∏‡∑ä‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∑è‡∂∫‡∑í‡∂ö ‡∂ö‡∂¥‡∑î | ‡∂ö‡∂¥‡∑î | 4500 | 6500 | ‡∂±‡∑í‡∂Ω‡∑ä | ‡∑É‡∑î‡∑Ä‡∂¥‡∑Ñ‡∑É‡∑î ‡∑É‡∑è‡∂ª‡∑í‡∂∫ | ‡∂¢‡∂±‡∂¥‡∑ä‚Äç‡∂ª‡∑í‡∂∫ | üëó
                </code>
            </div>

            <div class="step">
                <h4>Step 2: Sheet ‡∂ë‡∂ö Publish ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h4>
                <p>1. <strong>File</strong> ‚Üí <strong>Share</strong> ‚Üí <strong>Publish to web</strong></p>
                <p>2. Format ‡∂ë‡∂ö <strong>"Comma-separated values (.csv)"</strong> select ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
                <p>3. <strong>"Publish"</strong> click ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</p>
                <p>4. URL ‡∂ë‡∂ö copy ‡∂ö‡∂ª‡∂ú‡∂±‡∑ä‡∂± (‡∂∏‡∑ö ‡∑Ä‡∂ú‡∑ö ‡∂¥‡∑ô‡∂±‡∑ô‡∂∫‡∑í):</p>
                <code style="display: block; margin: 10px 0; padding: 10px; background: #f5f5f5; word-break: break-all; font-size: 0.75rem;">
                    https://docs.google.com/spreadsheets/d/e/YOUR-SHEET-ID/pub?output=csv
                </code>
            </div>

            <div class="step">
                <h4>Step 3: URL ‡∂ë‡∂ö ‡∂∏‡∑ô‡∑Ñ‡∑í Paste ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</h4>
                <div class="form-group">
                    <label>Google Sheets CSV URL:</label>
                    <input type="text" id="sheetUrl" placeholder="https://docs.google.com/spreadsheets/d/e/..." />
                </div>
                <button class="btn-primary" onclick="saveSheetUrl()">üíæ URL ‡∂ë‡∂ö Save ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
            </div>

            <div class="step">
                <h4>üìù ‡∑Ä‡∂≠‡∑ä‡∂∏‡∂±‡∑ä Sheet URL:</h4>
                <p id="currentUrl" style="word-break: break-all; background: #f5f5f5; padding: 10px; border-radius: 5px; margin-top: 10px;">
                    ‡∂≠‡∑Ä‡∂∏ set ‡∂ö‡∂ª ‡∂±‡∑ê‡∂≠
                </p>
                <button class="btn-primary" onclick="loadFromSheet()" style="margin-top: 10px; background: linear-gradient(135deg, var(--primary), var(--primary-dark));">
                    üîÑ Sheet ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä Products Load ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                </button>
            </div>

            <div class="info-box" style="background: #fff3cd; border-left-color: #ffc107;">
                <h3>üí° ‡∑Ä‡∑ê‡∂Ø‡∂ú‡∂≠‡∑ä ‡∑É‡∂ß‡∑Ñ‡∂±‡∑ä:</h3>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Sheet ‡∂ë‡∂ö update ‡∂ö‡∂ª‡∂± ‡∑Ä‡∑ô‡∂Ω‡∑è‡∑Ä‡∂Ω‡∂Ø‡∑ì website ‡∂ë‡∂ö automatic ‡∂Ω‡∑ô‡∑É update ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∑Ñ‡∑ê</li>
                    <li>"üîÑ Sheet ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä Products Load ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" button ‡∂ë‡∂ö click ‡∂ö‡∂ª‡∂±‡∑ä‡∂± updates ‡∂ú‡∂±‡∑ä‡∂±</li>
                    <li>Real-time updates ‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫ ‡∂±‡∂∏‡∑ä Google Apps Script use ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä</li>
                    <li>Image column ‡∂ë‡∂ö‡∑ö emojis ‡∑Ñ‡∑ù image URLs ‡∂Ø‡∑è‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        const SHEET_URL_KEY = 'googleSheetUrl';
        const PRODUCTS_CACHE_KEY = 'cachedProducts';

        // Get saved sheet URL
        function getSavedSheetUrl() {
            return localStorage.getItem(SHEET_URL_KEY) || '';
        }

        // Save sheet URL
        function saveSheetUrl() {
            const url = document.getElementById('sheetUrl').value.trim();
            
            if (!url) {
                alert('‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª valid Google Sheets URL ‡∂ë‡∂ö‡∂ö‡∑ä enter ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!');
                return;
            }

            // Validate URL format
            if (!url.includes('docs.google.com/spreadsheets') && !url.includes('output=csv')) {
                alert('Invalid URL! Sheet ‡∂ë‡∂ö publish to web ‡∂ö‡∂ª CSV format ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä URL ‡∂ë‡∂ö copy ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.');
                return;
            }

            localStorage.setItem(SHEET_URL_KEY, url);
            document.getElementById('currentUrl').textContent = url;
            
            alert('‚úÖ URL ‡∂ë‡∂ö save ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì! ‡∂Ø‡∑ê‡∂±‡∑ä "Sheet ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä Products Load ‡∂ö‡∂ª‡∂±‡∑ä‡∂±" click ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.');
        }

        // Load products from Google Sheet
        async function loadFromSheet() {
            const url = getSavedSheetUrl();
            
            if (!url) {
                alert('‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂¥‡∑Ö‡∂∏‡∑î‡∑Ä Google Sheets URL ‡∂ë‡∂ö save ‡∂ö‡∂ª‡∂±‡∑ä‡∂±!');
                return;
            }

            try {
                showLoading();
                
                // Fetch CSV data
                const response = await fetch(url);
                const csvText = await response.text();
                
                // Parse CSV
                const products = parseCSV(csvText);
                
                // Cache products
                localStorage.setItem(PRODUCTS_CACHE_KEY, JSON.stringify(products));
                
                // Display products
                displayProducts(products);
                
                alert(`‚úÖ ‡∑É‡∑è‡∂ª‡∑ä‡∂Æ‡∂ö‡∑Ä products ${products.length}‡∂ö‡∑ä load ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑ì!`);
            } catch (error) {
                console.error('Error loading from sheet:', error);
                alert('‚ùå Sheet ‡∂ë‡∂ö‡∑ô‡∂±‡∑ä load ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∑ö‡∂Ø‡∑ì ‡∂Ø‡∑ù‡∑Ç‡∂∫‡∂ö‡∑ä! URL ‡∂ë‡∂ö ‡∂±‡∑í‡∑Ä‡∑ê‡∂ª‡∂Ø‡∑í‡∂Ø ‡∂∂‡∂Ω‡∂±‡∑ä‡∂±.');
            }
        }

        // Parse CSV to products array
        function parseCSV(csv) {
            const lines = csv.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            
            const products = [];
            
            for (let i = 1; i < lines.length; i++) {
                const values = parseCSVLine(lines[i]);
                
                if (values.length < headers.length) continue;
                
                const product = {};
                headers.forEach((header, index) => {
                    product[header] = values[index] ? values[index].trim() : '';
                });
                
                // Convert to proper format
                products.push({
                    id: i,
                    name: product.name || '‡∂±‡∑í‡∑Ç‡∑ä‡∂¥‡∑è‡∂Ø‡∂±‡∂∫',
                    category: product.category || 'general',
                    price: parseInt(product.price) || 0,
                    originalPrice: parseInt(product.originalPrice) || null,
                    color: product.color || '',
                    description: product.description || '',
                    badge: product.badge || '',
                    image: product.image || 'üõçÔ∏è'
                });
            }
            
            return products;
        }

        // Parse single CSV line (handles commas in quotes)
        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    inQuotes = !inQuotes;
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result;
        }

        // Display products
        function displayProducts(products) {
            const grid = document.getElementById('productGrid');
            
            if (!products || products.length === 0) {
                grid.innerHTML = '<div class="loading">‚ùå ‡∂±‡∑í‡∑Ç‡∑ä‡∂¥‡∑è‡∂Ø‡∂± ‡∂±‡∑ê‡∂≠</div>';
                return;
            }
            
            grid.innerHTML = products.map(product => `
                <div class="product-card">
                    <div class="product-image">
                        <span style="font-size: 5rem;">${product.image}</span>
                        ${product.badge ? `<div class="product-badge">${product.badge}</div>` : ''}
                    </div>
                    <div class="product-info">
                        <div class="product-category">${product.category}</div>
                        <h3 class="product-name">${product.name}</h3>
                        <p style="color: var(--text-medium); font-size: 0.9rem; margin-bottom: 15px;">${product.description}</p>
                        <div class="product-price">
                            <span class="price">‡∂ª‡∑î. ${product.price.toLocaleString()}</span>
                            ${product.originalPrice ? `<span class="price-original">‡∂ª‡∑î. ${product.originalPrice.toLocaleString()}</span>` : ''}
                        </div>
                        <button class="add-to-cart-btn">‡∂ö‡∂ª‡∂≠‡∑ä‡∂≠‡∂∫‡∂ß ‡∂ë‡∂ö‡∂≠‡∑î ‡∂ö‡∂ª‡∂±‡∑ä‡∂±</button>
                    </div>
                </div>
            `).join('');
        }

        // Show loading
        function showLoading() {
            document.getElementById('productGrid').innerHTML = '<div class="loading">‚è≥ Loading...</div>';
        }

        // Load cached products on page load
        function loadCachedProducts() {
            const cached = localStorage.getItem(PRODUCTS_CACHE_KEY);
            
            if (cached) {
                try {
                    const products = JSON.parse(cached);
                    displayProducts(products);
                } catch (error) {
                    // Show default message
                    document.getElementById('productGrid').innerHTML = `
                        <div class="loading">
                            <p>Google Sheets integration setup ‡∂ö‡∂ª‡∂±‡∑ä‡∂± Admin Panel ‡∂ë‡∂ö‡∂ß ‡∂∫‡∂±‡∑ä‡∂±</p>
                            <button class="admin-btn" onclick="openAdmin()" style="margin-top: 20px; padding: 15px 30px; cursor: pointer;">
                                üîê Admin Panel Open ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                            </button>
                        </div>
                    `;
                }
            } else {
                // Show setup message
                document.getElementById('productGrid').innerHTML = `
                    <div class="loading">
                        <p style="margin-bottom: 20px;">üëã ‡∂Ü‡∂∫‡∑î‡∂∂‡∑ù‡∑Ä‡∂±‡∑ä! Google Sheets integration setup ‡∂ö‡∂ª‡∂±‡∑ä‡∂± Admin Panel ‡∂ë‡∂ö‡∂ß ‡∂∫‡∂±‡∑ä‡∂±</p>
                        <button class="admin-btn" onclick="openAdmin()" style="padding: 15px 30px; cursor: pointer; background: var(--accent); color: var(--text-dark); border: none; border-radius: 8px; font-weight: 700;">
                            üîê Admin Panel Open ‡∂ö‡∂ª‡∂±‡∑ä‡∂±
                        </button>
                    </div>
                `;
            }
        }

        // Admin panel functions
        function openAdmin() {
            document.getElementById('adminPanel').classList.add('active');
            
            // Show current URL
            const currentUrl = getSavedSheetUrl();
            document.getElementById('currentUrl').textContent = currentUrl || '‡∂≠‡∑Ä‡∂∏ set ‡∂ö‡∂ª ‡∂±‡∑ê‡∂≠';
            document.getElementById('sheetUrl').value = currentUrl;
        }

        function closeAdmin() {
            document.getElementById('adminPanel').classList.remove('active');
        }

        // Initialize on load
        window.addEventListener('DOMContentLoaded', () => {
            loadCachedProducts();
        });

        // Close admin panel with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeAdmin();
            }
        });
    </script>
</body>
</html>